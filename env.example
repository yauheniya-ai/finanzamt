# finanzamt — environment configuration
# Copy this file to .env and adjust values for your setup.
# All variables are optional; the defaults work out of the box with a local
# Ollama instance and system Tesseract.

# ---------------------------------------------------------------------------
# Ollama / LLM
# ---------------------------------------------------------------------------

# Base URL of your Ollama server.
FINANZAMT_OLLAMA_BASE_URL=http://localhost:11434

# Model to use for receipt extraction.
#
# Recommended options (pull with: ollama pull <model>):
#
#   llama3.2          — default, good accuracy, ~2 GB VRAM
#   qwen2.5:3b        — faster, lower memory (~2 GB), strong German support,
#                       good structured JSON output; recommended on CPU or
#                       machines with limited VRAM
#   mistral           — solid alternative, ~4 GB VRAM
#   phi3              — very lightweight, ~1.5 GB VRAM, lower accuracy
#
# To switch to qwen2.5:3b:
#   1. ollama pull qwen2.5:3b
#   2. Set FINANZAMT_MODEL=qwen2.5:3b below
#   3. Optionally reduce NUM_CTX to 2048 to save memory (receipts are short)
#
FINANZAMT_MODEL=llama3.2

# ---------------------------------------------------------------------------
# LLM inference parameters
# ---------------------------------------------------------------------------

# Sampling temperature. Keep low (0.0–0.2) for deterministic JSON extraction.
# Values above 0.5 will trigger a warning and produce inconsistent output.
FINANZAMT_TEMPERATURE=0.1

# Nucleus sampling threshold.
FINANZAMT_TOP_P=0.9

# Context window size in tokens.
# 4096 is safe for all models above.
# For qwen2.5:3b on memory-constrained hardware, 2048 is sufficient for
# typical German receipts (OCR text rarely exceeds 800 tokens).
FINANZAMT_NUM_CTX=4096

# ---------------------------------------------------------------------------
# OCR — Tesseract
# ---------------------------------------------------------------------------

# Path to the Tesseract binary.
# Leave as "tesseract" if it is on your PATH.
# Windows example: C:/Program Files/Tesseract-OCR/tesseract.exe
FINANZAMT_TESSERACT_CMD=tesseract

# Tesseract language packs joined with "+".
# Requires the packs to be installed:
#   Ubuntu/Debian: sudo apt-get install tesseract-ocr-deu
#   macOS:         brew install tesseract-lang
FINANZAMT_OCR_LANGUAGE=deu+eng

# Apply image pre-processing (denoising, contrast, binarisation) before OCR.
# Improves accuracy on low-quality scans; disable for clean digital PDFs.
FINANZAMT_OCR_PREPROCESS=true

# ---------------------------------------------------------------------------
# PDF rendering
# ---------------------------------------------------------------------------

# DPI used when rasterising scanned PDF pages for OCR.
# 300 is the standard for good OCR quality.
# Reduce to 150 to speed up processing on large batches.
FINANZAMT_PDF_DPI=300

# ---------------------------------------------------------------------------
# HTTP / retry
# ---------------------------------------------------------------------------

# Number of retry attempts when Ollama returns an error or times out.
FINANZAMT_MAX_RETRIES=3

# HTTP request timeout in seconds per attempt.
FINANZAMT_REQUEST_TIMEOUT=30
